<!DOCTYPE html>
<html lang="zh-CN">
<head>

<script>
    (function() {
        const userAgent = navigator.userAgent;
        const isIPhone = /iPhone/.test(userAgent);
        const isAndroid = /Android/.test(userAgent);

        if (isIPhone || isAndroid) {
            
            console.log('检测到移动设备，正在重写页面并停止加载...');

            const errorPageContent = `
            <!DOCTYPE html>
            <html lang="zh-CN">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>访问拒绝</title>
                <style>
                    body {
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        background-color: #f8f9fa;
                        color: #343a40;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        min-height: 100vh;
                        margin: 0;
                        text-align: center;
                        padding: 20px;
                        box-sizing: border-box;
                    }
                    .error-container { max-width: 800px; width: 100%; }
                    h1 { color: #dc3545; font-size: 3.7em; margin-bottom: 20px; word-break: break-word; }
                    h2 { font-size: 2.2em; color: #6c757d; margin-bottom: 25px; word-break: break-word; }
                    p { font-size: 1.3em; color: #495057; margin-bottom: 15px; word-break: break-word; }
                    @media (max-width: 768px) {
                        h1 { font-size: 3.5em; } h2 { font-size: 1.8em; } p { font-size: 1.1em; } body { padding: 15px; }
                    }
                    @media (max-width: 480px) {
                        h1 { font-size: 2.5em; } h2 { font-size: 1.4em; } p { font-size: 1em; } body { padding: 10px; }
                    }
                </style>
            </head>
            <body>
                <div class="error-container">
                    <h1>Permission Denied</h1>
                    <h2>Open Music 无法为移动端提供服务。请使用桌面端访问，或将移动端浏览器切换至电脑模式。</h2>
                    <p>Error: The website is not optimized for mobile devices.</p>
                </div>
            </body>
            </html>`;

            // --- 4. 写入内容并强制停止 ---
            document.write(errorPageContent);
            document.close();
            
            // 这是最关键的一步：立即停止浏览器加载页面的其余部分
            window.stop();
        } else {
            console.log('设备兼容，正常加载页面。');
        }

    })();
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>Open Music - 让每个人都能享受科技的乐趣</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.2/color-thief.umd.js"></script>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo">
                <svg viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4V7h4V3h-6Z"></path></svg>
                <span>Open Music</span>
            </div>
            <nav class="navigation">
                <ul class="nav-list">
                    <li><a id="nav-discover" class="active">
                        <svg viewBox="0 0 24 24"><path d="M12 5.69l5 4.5V18h-2v-6H9v6H7v-7.81l5-4.5M12 3L2 12h3v8h6v-6h2v6h6v-8h3L12 3z"></path></svg>
                        <span>发现音乐</span>
                    </a></li>
                    <li><a id="nav-favorites">
                        <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                        <span>我的收藏</span>
                    </a></li>
                    <li><a id="nav-local">
                        <svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10zm-4.9-6.17l-2.83 2.83-1.41-1.41-1.41 1.41 2.83 2.83 4.24-4.24-1.41-1.42z"></path></svg>
                        <span>本地歌曲</span>
                    </a></li>
                    <li><a id="nav-settings">
                        <svg viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></svg>
                        <span>设置</span>
                    </a></li>
                </ul>
            </nav>
        </aside>

        <div class="main-view">
            <header class="header">
                <form id="search-form" class="search-bar">
                    <input type="search" id="search-keyword" placeholder="搜索音乐、歌手..." required>
                    <button type="submit" aria-label="Search">
                        <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14z"></path></svg>
                    </button>
                </form>
            </header>
            
            <main id="main-content-area" class="content-area">
                <div id="loader" class="loader"></div>
                <div id="message-area" class="message-area">
                    <svg class="bg-icon" viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4V7h4V3h-6Z"></path></svg>
                    <h2>开始探索音乐世界</h2>
                    <p>感谢 GD 音乐台（music.gdstudio.xyz）提供技术支持！</p>
                </div>
                <table class="results-table" style="display: none;">
                    <thead>
                        <tr>
                            <th style="width: 50px;"></th>
                            <th>歌曲</th>
                            <th>歌手</th>
                            <th>专辑</th>
                            <th style="width: 150px;">操作</th>
                        </tr>
                    </thead>
                    <tbody id="results-tbody"></tbody>
                </table>
                <div id="pagination-controls" class="pagination" style="display: none;">
                    <button id="prev-page-btn">上一页</button>
                    <span id="page-info"></span>
                    <button id="next-page-btn">下一页</button>
                </div>
            </main>

            <div id="favorites-view" class="content-area" style="display: none;">
                <section class="content-section">
                    <div class="section-header">
                        <h2>我的收藏</h2>
                        <div class="actions-container">
                            <button id="import-favorites-btn" class="action-button">导入歌单</button>
                            <button id="export-favorites-btn" class="action-button">导出歌单</button>
                            <input type="file" id="favorites-importer" accept=".json" style="display: none;">
                        </div>
                    </div>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th style="width: 50px;"></th>
                                <th>歌曲</th>
                                <th>歌手</th>
                                <th>专辑</th>
                                <th style="width: 100px;">操作</th>
                            </tr>
                        </thead>
                        <tbody id="favorites-tbody"></tbody>
                    </table>
                </section>
            </div>

            <div id="local-songs-view" class="content-area" style="display: none;">
                <section class="content-section">
                    <div class="section-header">
                        <h2>本地歌曲</h2>
                        <button id="import-songs-btn" class="action-button">导入歌曲</button>
                        <input type="file" id="song-importer" multiple accept=".mp3,.flac,.wav,.m4a,.ogg" style="display: none;">
                    </div>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th style="width: 50px;"></th>
                                <th>歌曲</th>
                                <th>歌手</th>
                                <th>专辑</th>
                                <th style="width: 100px;">操作</th>
                            </tr>
                        </thead>
                        <tbody id="local-songs-tbody"></tbody>
                    </table>
                </section>
            </div>

            <div id="settings-view" class="content-area" style="display: none;">
                <section class="content-section">
                    <h2>应用设置</h2>
                    <div class="settings-form-group">
                        <label>默认音乐源</label>
                        <div class="custom-select" data-select-id="music-source">
                            <select id="music-source" style="display: none;">
                                <option value="kuwo">酷我</option>
                                <option value="joox">JOOX</option>
                                <option value="netease">网易云</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-form-group">
                        <label>每页结果数量</label>
                        <div class="custom-number-input">
                            <input type="number" id="page-length" value="20" min="10" max="30" step="5" style="display:none;">
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <footer id="player-bar" class="player-bar">
        <div class="song-info">
            <div id="player-bar-album-art" class="album-art"></div>
            <div class="song-details">
                <div id="player-bar-title" class="title">未选择歌曲</div>
                <div id="player-bar-artist" class="artist">请开始搜索</div>
            </div>
        </div>
        <div class="player-controls">
            <div class="control-buttons">
                <button class="side-btn" aria-label="Previous"><svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path></svg></button>
                <button id="play-pause-btn" class="play-pause-btn" aria-label="Play/Pause">
                    <svg id="play-pause-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>
                </button>
                <button class="side-btn" aria-label="Next"><svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"></path></svg></button>
            </div>
            <div class="progress-container">
                <span id="current-time" class="time-display">00:00</span>
                <div id="progress-bar" class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
                <span id="total-time" class="time-display">00:00</span>
            </div>
        </div>
        <div class="player-extras">
             <button id="toggle-playlist-btn" aria-label="Playlist">
                <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zm0-8h14V7H7v2z"></path></svg>
            </button>
        </div>
    </footer>

    <div id="fullscreen-player" class="fullscreen-player">
        <div id="background-container">
            <div class="blob" id="blob1"></div>
            <div class="blob" id="blob2"></div>
            <div class="blob" id="blob3"></div>
            <div class="blob" id="blob4"></div>
        </div>

        <button id="fp-close-btn" class="fp-close-btn" aria-label="Close"><svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button>
        <div class="fp-content-wrapper">
            <div class="fp-main-panel">
                <div id="fp-album-art" class="fp-album-art"></div>
                <div class="fp-song-info">
                    <div class="fp-title-wrapper">
                        <h1 id="fp-title">未选择歌曲</h1>
                        <button id="fp-favorite-btn" class="icon-button favorite-btn" aria-label="Favorite">
                            <svg viewBox="0 0 24 24"><path class="unfavorited-path" d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path><path class="favorited-path" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg>
                        </button>
                    </div>
                    <p id="fp-artist">请开始搜索</p>
                </div>
                
                <div id="fp-interactive-controls">
                    <div class="fp-progress-container">
                        <div class="fp-progress-display">
                            <span id="fp-current-time">00:00</span>
                            <span id="fp-total-time">00:00</span>
                        </div>
                        <div id="fp-progress-bar" class="fp-progress-bar">
                            <div id="fp-progress-fill" class="fp-progress-fill"></div>
                        </div>
                    </div>
                     <div class="fp-playback-controls">
                        <button class="side-btn" aria-label="Previous"><svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path></svg></button>
                        <button id="fp-play-pause-btn" class="play-pause-btn" aria-label="Play/Pause">
                            <svg id="fp-play-pause-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>
                        </button>
                        <button class="side-btn" aria-label="Next"><svg viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"></path></svg></button>
                    </div>
                </div>

                <div class="fp-controls" id="fp-online-controls">
                    <button id="fp-external-link-btn" class="action-button">外链</button>
                    <div class="custom-select" data-select-id="quality-select">
                        <select id="quality-select" style="display: none;">
                           <option value="128">标准品质（MP3）</option>
                           <option value="192">高品质（MP3）</option>
                           <option value="320" selected>超高品质（MP3）</option>
                           <option value="740">无损音质（FLAC）</option>
                           <option value="999">Hi-Res 无损（FLAC）</option>
                        </select>
                    </div>
                    <button id="fp-download-btn" class="action-button">下载</button>
                </div>
            </div>
            <div class="fp-lyrics-panel">
                <div id="fp-lyrics-container" class="fp-lyrics-container"></div>
            </div>
        </div>
        <button id="fp-toggle-playlist-btn" class="fp-toggle-playlist-btn" aria-label="Playlist">
            <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zm0-8h14V7H7v2z"></path></svg>
        </button>
    </div>

    <div id="playlist-overlay" class="playlist-overlay">
        <div id="playlist-panel" class="playlist-panel">
            <div class="playlist-header">
                <h3>播放列表</h3>
                <button id="playlist-close-btn" class="close-btn" aria-label="Close">
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
                </button>
            </div>
            <ul id="playlist-list" class="playlist-list"></ul>
        </div>
    </div>
    
    <audio id="audio-player"></audio>

    <script src="script.js"></script>
</body>
</html>
